library("tibble")
library("ggpubr")
library("patchwork")
library("dplyr")
library("tidyverse")
library("heatwaveR") # For detecting MHWs
library("phyloseq") #For ASV input
library("RColorBrewer")
Sys.setlocale("LC_ALL","English")
OISST <- readRDS("shimoda_time_series_updated.rda")
ts <- ts2clm(OISST, climatologyPeriod = c("1982-01-01", "2011-12-31"))
mhw <- detect_event(ts)
mhw2 <- mhw$climatology %>%
filter(between(t, as.Date("2013-09-13"), as.Date("2020-12-08")))
mhw2.plot <- ggplot(data = mhw2, aes(x = t)) +
geom_line(aes(y = temp, colour = "temp"), size = 0.5) +
geom_flame(aes(y = temp, y2 = thresh, fill = "event"), show.legend = T) +
scale_colour_manual(name = "Line Colour",
values = c("temp" = "black",
"thresh" =  "grey60",
"seas" = "black")) +
scale_fill_manual(name = "Event Colour",
values = c("event" = "red")) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%b %Y") +
guides(colour = guide_legend(override.aes = list(fill = NA))) +
labs(y= expression(atop(paste(bold("Daily SST")), paste("(",degree ~C," )")))) +
coord_cartesian(ylim = c(10, 30)) +
theme_pubr() + theme(legend.position = "none") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text (size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7))
#Setting up prevalence data
#Prevalence of sediment-trapping G. elegans, prevalence of disease and number of disease occurrences per survey
SC.G.elegans.data <-
read_csv("Dis_Monthly_Monitoring.csv") %>%
mutate(Date = as.Date(Date)) %>%
mutate(Coverage_Deg_G_elegans = (Deg_G_Elegans/64)*100) %>%
group_by(Date) %>%
get_summary_stats(type = "mean_sd",WMS_Prevalence, Coverage_Deg_G_elegans) %>%
filter(variable %in% "Coverage_Deg_G_elegans")
Prevalence.data <-
read_csv("Dis_Monthly_Monitoring.csv") %>%
mutate(Date = as.Date(Date)) %>%
filter(between(Date, as.Date("2013-09-13"), as.Date("2020-12-08"))) %>%
mutate(Coverage_Deg_G_elegans = (Deg_G_Elegans/64)*100) %>%
mutate(Percent_Prev = (WMS_Prevalence*100)) %>%
group_by(Date) %>%
get_summary_stats(type = "mean_sd",Percent_Prev, Coverage_Deg_G_elegans) %>%
filter(variable %in% "Percent_Prev")
SC.GE.plot <-
ggplot(data = SC.G.elegans.data, aes(x = Date)) +
geom_line(aes(y = mean)) +
geom_point(aes(y = mean),size = 1) +
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd)) +
labs(y= expression(atop(paste(bold("Sediment Trapping"~bolditalic("G. elegans"))), paste("(% of Total Coverage)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 7)) +
coord_cartesian(ylim = c(0, 20)) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis.Prev.plot <-
ggplot(data = Prevalence.data, aes(x = Date, y = mean)) +
geom_line() +
geom_point(size = 1) +
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd)) +
labs(y= expression(atop(paste(bold("Disease")), paste("(% of Coral Coverage)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7) )+
coord_cartesian(ylim = c(0, 40)) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis_Count.data <- read_csv("Dis_Count.csv")
OISST <- readRDS("shimoda_time_series_updated.rda")
ts <- ts2clm(OISST, climatologyPeriod = c("1982-01-01", "2011-12-31"))
mhw <- detect_event(ts)
mhw2 <- mhw$climatology %>%
filter(between(t, as.Date("2013-09-13"), as.Date("2020-12-08")))
mhw2.plot <- ggplot(data = mhw2, aes(x = t)) +
geom_line(aes(y = temp, colour = "temp"), size = 0.5) +
geom_flame(aes(y = temp, y2 = thresh, fill = "event"), show.legend = T) +
scale_colour_manual(name = "Line Colour",
values = c("temp" = "black",
"thresh" =  "grey60",
"seas" = "black")) +
scale_fill_manual(name = "Event Colour",
values = c("event" = "red")) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%b %Y") +
guides(colour = guide_legend(override.aes = list(fill = NA))) +
labs(y= expression(atop(paste(bold("Daily SST")), paste("(",degree ~C," )")))) +
coord_cartesian(ylim = c(10, 30)) +
theme_pubr() + theme(legend.position = "none") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text (size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7))
#Setting up prevalence data
#Prevalence of sediment-trapping G. elegans, prevalence of disease and number of disease occurrences per survey
SC.G.elegans.data <-
read_csv("Dis_Monthly_Monitoring.csv") %>%
mutate(Date = as.Date(Date)) %>%
mutate(Coverage_Deg_G_elegans = (Deg_G_Elegans/64)*100) %>%
group_by(Date) %>%
get_summary_stats(type = "mean_sd",WMS_Prevalence, Coverage_Deg_G_elegans) %>%
filter(variable %in% "Coverage_Deg_G_elegans")
Prevalence.data <-
read_csv("Dis_Monthly_Monitoring.csv") %>%
mutate(Date = as.Date(Date)) %>%
filter(between(Date, as.Date("2013-09-13"), as.Date("2020-12-08"))) %>%
mutate(Coverage_Deg_G_elegans = (Deg_G_Elegans/64)*100) %>%
mutate(Percent_Prev = (WMS_Prevalence*100)) %>%
group_by(Date) %>%
get_summary_stats(type = "mean_sd",Percent_Prev, Coverage_Deg_G_elegans) %>%
filter(variable %in% "Percent_Prev")
SC.GE.plot <-
ggplot(data = SC.G.elegans.data, aes(x = Date)) +
geom_line(aes(y = mean)) +
geom_point(aes(y = mean),size = 1) +
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd)) +
labs(y= expression(atop(paste(bold("Sediment Trapping"~bolditalic("G. elegans"))), paste("(% of Total Coverage)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 7)) +
coord_cartesian(ylim = c(0, 20)) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis.Prev.plot <-
ggplot(data = Prevalence.data, aes(x = Date, y = mean)) +
geom_line() +
geom_point(size = 1) +
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd)) +
labs(y= expression(atop(paste(bold("Disease")), paste("(% of Coral Coverage)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7) )+
coord_cartesian(ylim = c(0, 40)) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis_Count.data <- read_csv("Dis_Count.csv")
Dis_Count.plot <- ggplot(data = Dis_Count.data, aes(x = Date, y = Dis_Count)) +
geom_point(size = 1) +
geom_line() +
labs(x = "", y= expression(atop(paste(bold("Disease")), paste("(# of Occurrences)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7) )+
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis.Prev.plot/Dis_Count.plot/mhw2.plot/SC.GE.plot + plot_annotation(tag_levels = 'A')
OISST <- readRDS("shimoda_time_series_updated.rda")
ts <- ts2clm(OISST, climatologyPeriod = c("1982-01-01", "2011-12-31"))
mhw <- detect_event(ts)
mhw2 <- mhw$climatology %>%
filter(between(t, as.Date("2013-09-13"), as.Date("2020-12-08")))
mhw2.plot <- ggplot(data = mhw2, aes(x = t)) +
geom_line(aes(y = temp, colour = "temp"), size = 0.5) +
geom_flame(aes(y = temp, y2 = thresh, fill = "event"), show.legend = T) +
scale_colour_manual(name = "Line Colour",
values = c("temp" = "black",
"thresh" =  "grey60",
"seas" = "black")) +
scale_fill_manual(name = "Event Colour",
values = c("event" = "red")) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%b %Y") +
guides(colour = guide_legend(override.aes = list(fill = NA))) +
labs(y= expression(atop(paste(bold("Daily SST")), paste("(",degree ~C," )")))) +
coord_cartesian(ylim = c(10, 30)) +
theme_pubr() + theme(legend.position = "none") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text (size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7))
#Setting up prevalence data
#Prevalence of sediment-trapping G. elegans, prevalence of disease and number of disease occurrences per survey
SC.G.elegans.data <-
read_csv("Dis_Monthly_Monitoring.csv") %>%
mutate(Date = as.Date(Date)) %>%
mutate(Coverage_Deg_G_elegans = (Deg_G_Elegans/64)*100) %>%
group_by(Date) %>%
get_summary_stats(type = "mean_sd",WMS_Prevalence, Coverage_Deg_G_elegans) %>%
filter(variable %in% "Coverage_Deg_G_elegans")
Prevalence.data <-
read_csv("Dis_Monthly_Monitoring.csv") %>%
mutate(Date = as.Date(Date)) %>%
filter(between(Date, as.Date("2013-09-13"), as.Date("2020-12-08"))) %>%
mutate(Coverage_Deg_G_elegans = (Deg_G_Elegans/64)*100) %>%
mutate(Percent_Prev = (WMS_Prevalence*100)) %>%
group_by(Date) %>%
get_summary_stats(type = "mean_sd",Percent_Prev, Coverage_Deg_G_elegans) %>%
filter(variable %in% "Percent_Prev")
SC.GE.plot <-
ggplot(data = SC.G.elegans.data, aes(x = Date)) +
geom_line(aes(y = mean)) +
geom_point(aes(y = mean),size = 1) +
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd)) +
labs(y= expression(atop(paste(bold("Sediment Trapping"~bolditalic("G. elegans"))), paste("(% of Total Coverage)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 7)) +
coord_cartesian(ylim = c(0, 20)) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis.Prev.plot <-
ggplot(data = Prevalence.data, aes(x = Date, y = mean)) +
geom_line() +
geom_point(size = 1) +
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd)) +
labs(y= expression(atop(paste(bold("Disease")), paste("(% of Coral Coverage)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7) )+
coord_cartesian(ylim = c(0, 40)) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis_Count.data <- read_csv("Dis_Count.csv")
Dis_Count.plot <- ggplot(data = Dis_Count.data, aes(x = Date, y = Dis_Count)) +
geom_point(size = 1) +
geom_line() +
labs(x = "", y= expression(atop(paste(bold("Disease")), paste("(# of Occurrences)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7) )+
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis.Prev.plot/Dis_Count.plot/mhw2.plot/SC.GE.plot + plot_annotation(tag_levels = 'A')
OISST <- readRDS("shimoda_time_series_updated.rda")
ts <- ts2clm(OISST, climatologyPeriod = c("1982-01-01", "2011-12-31"))
mhw <- detect_event(ts)
mhw2 <- mhw$climatology %>%
filter(between(t, as.Date("2013-09-13"), as.Date("2020-12-08")))
mhw2.plot <- ggplot(data = mhw2, aes(x = t)) +
geom_line(aes(y = temp, colour = "temp"), size = 0.5) +
geom_flame(aes(y = temp, y2 = thresh, fill = "event"), show.legend = T) +
scale_colour_manual(name = "Line Colour",
values = c("temp" = "black",
"thresh" =  "grey60",
"seas" = "black")) +
#  scale_fill_manual(name = "Event Colour",
#                    values = c("event" = "red")) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%b %Y") +
guides(colour = guide_legend(override.aes = list(fill = NA))) +
labs(y= expression(atop(paste(bold("Daily SST")), paste("(",degree ~C," )")))) +
coord_cartesian(ylim = c(10, 30)) +
theme_pubr() + theme(legend.position = "none") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text (size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7))
#Setting up prevalence data
#Prevalence of sediment-trapping G. elegans, prevalence of disease and number of disease occurrences per survey
SC.G.elegans.data <-
read_csv("Dis_Monthly_Monitoring.csv") %>%
mutate(Date = as.Date(Date)) %>%
mutate(Coverage_Deg_G_elegans = (Deg_G_Elegans/64)*100) %>%
group_by(Date) %>%
get_summary_stats(type = "mean_sd",WMS_Prevalence, Coverage_Deg_G_elegans) %>%
filter(variable %in% "Coverage_Deg_G_elegans")
Prevalence.data <-
read_csv("Dis_Monthly_Monitoring.csv") %>%
mutate(Date = as.Date(Date)) %>%
filter(between(Date, as.Date("2013-09-13"), as.Date("2020-12-08"))) %>%
mutate(Coverage_Deg_G_elegans = (Deg_G_Elegans/64)*100) %>%
mutate(Percent_Prev = (WMS_Prevalence*100)) %>%
group_by(Date) %>%
get_summary_stats(type = "mean_sd",Percent_Prev, Coverage_Deg_G_elegans) %>%
filter(variable %in% "Percent_Prev")
SC.GE.plot <-
ggplot(data = SC.G.elegans.data, aes(x = Date)) +
geom_line(aes(y = mean)) +
geom_point(aes(y = mean),size = 1) +
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd)) +
labs(y= expression(atop(paste(bold("Sediment Trapping"~bolditalic("G. elegans"))), paste("(% of Total Coverage)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 7)) +
coord_cartesian(ylim = c(0, 20)) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis.Prev.plot <-
ggplot(data = Prevalence.data, aes(x = Date, y = mean)) +
geom_line() +
geom_point(size = 1) +
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd)) +
labs(y= expression(atop(paste(bold("Disease")), paste("(% of Coral Coverage)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7) )+
coord_cartesian(ylim = c(0, 40)) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis_Count.data <- read_csv("Dis_Count.csv")
Dis_Count.plot <- ggplot(data = Dis_Count.data, aes(x = Date, y = Dis_Count)) +
geom_point(size = 1) +
geom_line() +
labs(x = "", y= expression(atop(paste(bold("Disease")), paste("(# of Occurrences)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7) )+
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis.Prev.plot/Dis_Count.plot/mhw2.plot/SC.GE.plot + plot_annotation(tag_levels = 'A')
OISST <- readRDS("shimoda_time_series_updated.rda")
ts <- ts2clm(OISST, climatologyPeriod = c("1982-01-01", "2011-12-31"))
mhw <- detect_event(ts)
mhw2 <- mhw$climatology %>%
filter(between(t, as.Date("2013-09-13"), as.Date("2020-12-08")))
mhw2.plot <- ggplot(data = mhw2, aes(x = t)) +
geom_line(aes(y = temp, colour = "temp"), size = 0.5) +
geom_flame(aes(y = temp, y2 = thresh, fill = "event"), show.legend = T) +
scale_colour_manual(name = "Line Colour",
values = c("temp" = "black",
#                                 "thresh" =  "grey60",
"seas" = "black")) +
#  scale_fill_manual(name = "Event Colour",
#                    values = c("event" = "red")) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%b %Y") +
guides(colour = guide_legend(override.aes = list(fill = NA))) +
labs(y= expression(atop(paste(bold("Daily SST")), paste("(",degree ~C," )")))) +
coord_cartesian(ylim = c(10, 30)) +
theme_pubr() + theme(legend.position = "none") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text (size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7))
#Setting up prevalence data
#Prevalence of sediment-trapping G. elegans, prevalence of disease and number of disease occurrences per survey
SC.G.elegans.data <-
read_csv("Dis_Monthly_Monitoring.csv") %>%
mutate(Date = as.Date(Date)) %>%
mutate(Coverage_Deg_G_elegans = (Deg_G_Elegans/64)*100) %>%
group_by(Date) %>%
get_summary_stats(type = "mean_sd",WMS_Prevalence, Coverage_Deg_G_elegans) %>%
filter(variable %in% "Coverage_Deg_G_elegans")
Prevalence.data <-
read_csv("Dis_Monthly_Monitoring.csv") %>%
mutate(Date = as.Date(Date)) %>%
filter(between(Date, as.Date("2013-09-13"), as.Date("2020-12-08"))) %>%
mutate(Coverage_Deg_G_elegans = (Deg_G_Elegans/64)*100) %>%
mutate(Percent_Prev = (WMS_Prevalence*100)) %>%
group_by(Date) %>%
get_summary_stats(type = "mean_sd",Percent_Prev, Coverage_Deg_G_elegans) %>%
filter(variable %in% "Percent_Prev")
SC.GE.plot <-
ggplot(data = SC.G.elegans.data, aes(x = Date)) +
geom_line(aes(y = mean)) +
geom_point(aes(y = mean),size = 1) +
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd)) +
labs(y= expression(atop(paste(bold("Sediment Trapping"~bolditalic("G. elegans"))), paste("(% of Total Coverage)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 7)) +
coord_cartesian(ylim = c(0, 20)) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis.Prev.plot <-
ggplot(data = Prevalence.data, aes(x = Date, y = mean)) +
geom_line() +
geom_point(size = 1) +
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd)) +
labs(y= expression(atop(paste(bold("Disease")), paste("(% of Coral Coverage)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7) )+
coord_cartesian(ylim = c(0, 40)) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis_Count.data <- read_csv("Dis_Count.csv")
Dis_Count.plot <- ggplot(data = Dis_Count.data, aes(x = Date, y = Dis_Count)) +
geom_point(size = 1) +
geom_line() +
labs(x = "", y= expression(atop(paste(bold("Disease")), paste("(# of Occurrences)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7) )+
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis.Prev.plot/Dis_Count.plot/mhw2.plot/SC.GE.plot + plot_annotation(tag_levels = 'A')
OISST <- readRDS("shimoda_time_series_updated.rda")
ts <- ts2clm(OISST, climatologyPeriod = c("1982-01-01", "2011-12-31"))
mhw <- detect_event(ts)
mhw2 <- mhw$climatology %>%
filter(between(t, as.Date("2013-09-13"), as.Date("2020-12-08")))
mhw2.plot <- ggplot(data = mhw2, aes(x = t)) +
geom_line(aes(y = temp, colour = "temp"), size = 0.5) +
#  geom_flame(aes(y = temp, y2 = thresh, fill = "event"), show.legend = T) +
scale_colour_manual(name = "Line Colour",
values = c("temp" = "black",
"thresh" =  "grey60",
"seas" = "black")) +
scale_fill_manual(name = "Event Colour",
values = c("event" = "red")) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%b %Y") +
guides(colour = guide_legend(override.aes = list(fill = NA))) +
labs(y= expression(atop(paste(bold("Daily SST")), paste("(",degree ~C," )")))) +
coord_cartesian(ylim = c(10, 30)) +
theme_pubr() + theme(legend.position = "none") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text (size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7))
#Setting up prevalence data
#Prevalence of sediment-trapping G. elegans, prevalence of disease and number of disease occurrences per survey
SC.G.elegans.data <-
read_csv("Dis_Monthly_Monitoring.csv") %>%
mutate(Date = as.Date(Date)) %>%
mutate(Coverage_Deg_G_elegans = (Deg_G_Elegans/64)*100) %>%
group_by(Date) %>%
get_summary_stats(type = "mean_sd",WMS_Prevalence, Coverage_Deg_G_elegans) %>%
filter(variable %in% "Coverage_Deg_G_elegans")
Prevalence.data <-
read_csv("Dis_Monthly_Monitoring.csv") %>%
mutate(Date = as.Date(Date)) %>%
filter(between(Date, as.Date("2013-09-13"), as.Date("2020-12-08"))) %>%
mutate(Coverage_Deg_G_elegans = (Deg_G_Elegans/64)*100) %>%
mutate(Percent_Prev = (WMS_Prevalence*100)) %>%
group_by(Date) %>%
get_summary_stats(type = "mean_sd",Percent_Prev, Coverage_Deg_G_elegans) %>%
filter(variable %in% "Percent_Prev")
SC.GE.plot <-
ggplot(data = SC.G.elegans.data, aes(x = Date)) +
geom_line(aes(y = mean)) +
geom_point(aes(y = mean),size = 1) +
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd)) +
labs(y= expression(atop(paste(bold("Sediment Trapping"~bolditalic("G. elegans"))), paste("(% of Total Coverage)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 7)) +
coord_cartesian(ylim = c(0, 20)) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis.Prev.plot <-
ggplot(data = Prevalence.data, aes(x = Date, y = mean)) +
geom_line() +
geom_point(size = 1) +
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd)) +
labs(y= expression(atop(paste(bold("Disease")), paste("(% of Coral Coverage)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7) )+
coord_cartesian(ylim = c(0, 40)) +
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis_Count.data <- read_csv("Dis_Count.csv")
Dis_Count.plot <- ggplot(data = Dis_Count.data, aes(x = Date, y = Dis_Count)) +
geom_point(size = 1) +
geom_line() +
labs(x = "", y= expression(atop(paste(bold("Disease")), paste("(# of Occurrences)")))) +
geom_hline(yintercept = 0, color = "grey") +
theme_pubr() +
theme(
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 7) )+
scale_x_date(expand = c(0.004,0.004), date_breaks = "1 year", date_labels = "%Y")
Dis.Prev.plot/Dis_Count.plot/mhw2.plot/SC.GE.plot + plot_annotation(tag_levels = 'A')
